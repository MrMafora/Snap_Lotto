
[deployment]
deploymentTarget = "cloudrun"
ignorePorts = true

[[deployment.env]]
key = "FLASK_APP"
value = "main.py"

[[deployment.env]]
key = "FLASK_ENV"
value = "production"

[[deployment.env]]
key = "PYTHONUNBUFFERED"
value = "1"

[[deployment.env]]
key = "PIP_NO_CACHE_DIR"
value = "1"

[[deployment.env]]
key = "PIP_DISABLE_PIP_VERSION_CHECK"
value = "1"

[[deployment.env]]
key = "PYTHONDONTWRITEBYTECODE"
value = "1"

[[deployment.env]]
key = "PIP_BREAK_SYSTEM_PACKAGES"
value = "1"

[[deployment.env]]
key = "PIP_ROOT_USER_ACTION"
value = "ignore"

[[deployment.env]]
key = "PIP_NO_BUILD_ISOLATION"
value = "1"

[deployment.build]
run = ["pip", "install", "--no-cache-dir", "--no-compile", "--prefer-binary", "--only-binary=:all:", "-r", "requirements-prod.txt"]

[deployment.run]
run = ["gunicorn", "--bind", "0.0.0.0:${PORT:-8080}", "--workers=1", "--timeout=60", "main:app"]
