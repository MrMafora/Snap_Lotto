<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
    <!-- Consent Manager removed as requested -->
    
    <!-- Extra meta content for page-specific early loading scripts -->
    {% block extra_meta %}{% endblock %}
    
    <!-- Optimized Google Analytics - Defer loading -->
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-M4NREF90ZD');
      
      // Load GA script after page loads
      window.addEventListener('load', function() {
        var script = document.createElement('script');
        script.async = true;
        script.src = 'https://www.googletagmanager.com/gtag/js?id=G-M4NREF90ZD';
        document.head.appendChild(script);
      });
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>{% block title %}Snap Lotto{% endblock %}</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="{% block meta_description %}Snap Lotto - South Africa's #1 Lottery, PowerBall & Daily Lottery Scanner App. The ONLY app with official Ithuba Lottery, PowerBall & Daily Lottery data, Snap Scan and Win = Phanda Phusha Play{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}Snap Lotto, South Africa PowerBall, South Africa Daily Lotto, Ithuba official results, PowerBall ticket scanner, Daily Lotto ticket scanner, PowerBall numbers, Daily Lotto results, direct Ithuba data, official lottery data South Africa{% endblock %}">
    <meta name="author" content="Snap Lotto">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large">
    <meta name="language" content="English">
    <meta name="geo.region" content="ZA">
    <meta name="geo.placename" content="South Africa">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="{% block og_title %}Snap Lotto | South Africa's #1 Lottery, PowerBall & Daily Lottery Scanner App{% endblock %}">
    <meta property="og:description" content="{% block og_description %}The ONLY app with official Ithuba Lottery, PowerBall & Daily Lottery data, Snap Scan and Win = Phanda Phusha Play{% endblock %}">
    <meta property="og:image" content="{{ url_for('static', filename='img/snap-lotto-social.jpg', _external=True) }}">
    <meta property="og:locale" content="en_ZA">
    <meta property="og:site_name" content="Snap Lotto">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ request.url }}">
    <meta property="twitter:title" content="{% block twitter_title %}Snap Lotto | South Africa's #1 Lottery, PowerBall & Daily Lottery Scanner App{% endblock %}">
    <meta property="twitter:description" content="{% block twitter_description %}The ONLY app with official Ithuba Lottery, PowerBall & Daily Lottery data, Snap Scan and Win = Phanda Phusha Play{% endblock %}">
    <meta property="twitter:image" content="{{ url_for('static', filename='img/snap-lotto-social.jpg', _external=True) }}">
    
    <!-- Canonical URL -->
    {% if request.path == '/ticket-scanner' or request.path == '/scanner-landing' %}
    <link rel="canonical" href="{{ url_for('scanner_landing', _external=True) }}">
    {% else %}
    <link rel="canonical" href="{{ request.url }}">
    {% endif %}
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="{{ url_for('static', filename='css/custom.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="{{ url_for('static', filename='css/lottery.css') }}?v=20250608" as="style" onload="this.onload=null;this.rel='stylesheet'">

    <link rel="preload" href="{{ url_for('static', filename='css/badge-fix.css') }}" as="style" onload="this.onload=null;this.rel='stylesheet'">

    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    
    <!-- Fallback for no-JS -->
    <noscript>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/lottery.css') }}?v=20250608">

        <link rel="stylesheet" href="{{ url_for('static', filename='css/badge-fix.css') }}">
    
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    </noscript>
    
    <!-- Defer JavaScript loading -->
    <script>
        // Load Bootstrap JS after page loads
        window.addEventListener('load', function() {
            var script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js';
            document.head.appendChild(script);
        });
    </script>
    <!-- Mobile optimization -->
    <meta name="theme-color" content="#FFE11D">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <!-- Content Security Policy with needed permissions -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https://www.googletagmanager.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; font-src 'self' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; img-src 'self' data:;">
    
    {% if config.get('ENVIRONMENT') == 'production' %}
    <!-- Google AdSense - Only loaded in production environment -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3172540139156466" crossorigin="anonymous"></script>
    {% endif %}
    
    {% block additional_head %}{% endblock %}
    {% block head_content %}{% endblock %}
</head>
<body class="{% block body_class %}{% endblock %}">
    <nav class="navbar navbar-expand-lg mb-2 sticky-top">
        <div class="container-fluid px-2">
            <a class="navbar-brand" href="/">
                <div class="lottery-logo">
                    <i class="fas fa-bolt" style="font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important; font-weight: 900 !important; visibility: visible !important; display: inline-block !important; opacity: 1 !important;"></i>
                    <span class="d-none d-sm-inline">SNAP LOTTO</span>
                    <span class="d-inline d-sm-none">SL</span>
                </div>
            </a>
            <!-- Mobile navigation handled by bottom nav bar, desktop navigation shown directly -->
            <div class="d-none d-lg-block" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center py-2" href="/"><i class="fas fa-home me-2" style="font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important; font-weight: 900 !important; visibility: visible !important; display: inline-block !important; opacity: 1 !important;"></i> Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center py-2" href="/results"><i class="fas fa-list-ol me-2" style="font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important; font-weight: 900 !important; visibility: visible !important; display: inline-block !important; opacity: 1 !important;"></i> Results</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center py-2" href="/guides"><i class="fas fa-book me-2" style="font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important; font-weight: 900 !important; visibility: visible !important; display: inline-block !important; opacity: 1 !important;"></i> Guides</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center py-2" href="/visualizations"><i class="fas fa-chart-bar me-2" style="font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important; font-weight: 900 !important; visibility: visible !important; display: inline-block !important; opacity: 1 !important;"></i> Analytics</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link d-flex align-items-center py-2 {% if request.path == '/ticket-scanner' or request.path == '/scan-lottery-ticket-south-africa' or request.path == '/scanner-landing' %}active{% endif %}" href="/scanner-landing"><i class="fas fa-ticket-alt me-2" style="font-family: 'Font Awesome 6 Free', 'Font Awesome 5 Free', FontAwesome !important; font-weight: 900 !important; visibility: visible !important; display: inline-block !important; opacity: 1 !important;"></i> Scanner</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    {% if current_user.is_authenticated %}
                        {% if current_user.is_admin %}
                            <li class="nav-item">
                                <a class="nav-link d-flex align-items-center py-2" href="{{ url_for('admin') }}"><i class="fas fa-shield-alt me-2"></i> Admin</a>
                            </li>
                        {% endif %}
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center py-2" href="/logout"><i class="fas fa-sign-out-alt me-2"></i> Logout</a>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link d-flex align-items-center py-2" href="{{ url_for('login') }}"><i class="fas fa-sign-in-alt me-2"></i> Login</a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Ad containers for loader and interstitial ads -->
    <div id="ad-container-loader" style="display: none;"></div>
    <div id="ad-container-interstitial" style="display: none;"></div>
    
    <div class="{% block container_class %}container{% endblock %} px-2 px-sm-3">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show mb-2">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Breadcrumb navigation with schema.org markup -->
        {% if breadcrumbs is defined and breadcrumbs %}
        <nav aria-label="breadcrumb" class="mb-3">
            <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
                <li class="breadcrumb-item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                    <a href="/" itemprop="item"><span itemprop="name">Home</span></a>
                    <meta itemprop="position" content="1" />
                </li>
                {% for breadcrumb in breadcrumbs %}
                    <li class="breadcrumb-item {% if loop.last %}active{% endif %}" 
                        itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
                        {% if not loop.last %}
                            <a href="{{ breadcrumb.url }}" itemprop="item">
                                <span itemprop="name">{{ breadcrumb.name }}</span>
                            </a>
                        {% else %}
                            <span itemprop="name">{{ breadcrumb.name }}</span>
                        {% endif %}
                        <meta itemprop="position" content="{{ loop.index + 1 }}" />
                    </li>
                {% endfor %}
            </ol>
        </nav>
        {% endif %}

        {% block content %}{% endblock %}
    </div>

    <footer class="footer mt-4 py-3">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3 mb-md-0">
                    <h5 class="h6 mb-2">Snap Lotto</h5>
                    <p class="small mb-2">South Africa's #1 Lottery, PowerBall & Daily Lottery Scanner App. The ONLY app with official Ithuba Lottery, PowerBall & Daily Lottery data, Snap Scan and Win = Phanda Phusha Play</p>
                    <p class="small">&copy; 2025 Snap Lotto</p>
                </div>
                <div class="col-md-3 mb-3 mb-md-0">
                    <h5 class="h6 mb-2">Lottery Games</h5>
                    <ul class="list-unstyled small">
                        <li><a href="/results?game=Lotto" class="text-decoration-none">SA Lotto Results</a></li>
                        <li><a href="/results?game=Powerball" class="text-decoration-none">PowerBall Results</a></li>
                        <li><a href="/results?game=Daily+Lotto" class="text-decoration-none">Daily Lotto Results</a></li>
                        <li><a href="/visualizations" class="text-decoration-none">Lottery Analysis</a></li>
                    </ul>
                </div>
                <div class="col-md-3 mb-3 mb-md-0">
                    <h5 class="h6 mb-2">Quick Links</h5>
                    <ul class="list-unstyled small">
                        <li><a href="/scanner-landing" class="text-decoration-none">Scan Your Ticket</a></li>
                        <li><a href="/guides/how-to-play-lotto" class="text-decoration-none">How to Play Lotto</a></li>
                        <li><a href="/guides/how-to-play-powerball" class="text-decoration-none">How to Play PowerBall</a></li>
                        <li><a href="/guides/how-to-play-daily-lotto" class="text-decoration-none">How to Play Daily Lotto</a></li>
                    </ul>
                </div>
                <div class="col-md-2">
                    <h5 class="h6 mb-2">Connect</h5>
                    <p class="small mb-2"><a href="https://www.snaplotto.co.za" class="text-decoration-none" target="_blank">www.snaplotto.co.za</a></p>
                    <div class="d-flex gap-2">
                        <a href="#" class="text-decoration-none" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="text-decoration-none" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-decoration-none" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Mobile navigation (only on mobile) -->
    <style>
    /* Mobile navigation - force fixed positioning */
    #mobile-nav {
        position: fixed !important;
        bottom: 0 !important;
        left: 0 !important;
        right: 0 !important;
        width: 100% !important;
        height: 60px !important;
        background: white !important;
        border-top: 1px solid #ddd !important;
        box-shadow: 0 -2px 4px rgba(0,0,0,0.1) !important;
        z-index: 9999 !important;
        display: flex !important;
    }
    
    #mobile-nav a {
        flex: 1 !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
        justify-content: center !important;
        color: #666 !important;
        text-decoration: none !important;
        font-size: 10px !important;
        padding: 4px !important;
    }
    
    #mobile-nav a i {
        font-size: 16px !important;
        margin-bottom: 2px !important;
    }
    
    #mobile-nav a.active {
        color: #dc3545 !important;
    }
    
    /* Add bottom padding to body on mobile */
    @media (max-width: 991px) {
        body { 
            padding-bottom: 70px !important; 
            margin-bottom: 0 !important;
        }
    }
    
    /* Hide on desktop */
    @media (min-width: 992px) {
        #mobile-nav { 
            display: none !important; 
        }
        body {
            padding-bottom: 0 !important;
        }
    }
    </style>
    
    <!-- Simple Mobile Navigation -->
    <div style="position: fixed; bottom: 0; left: 0; right: 0; height: 60px; background: white; border-top: 1px solid #ddd; z-index: 999999; display: flex;" class="d-lg-none">
        <a href="/" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: {% if request.path == '/' %}#dc3545{% else %}#666{% endif %};">
            <i class="fas fa-home" style="font-size: 16px; margin-bottom: 2px;"></i>
            <small>Home</small>
        </a>
        <a href="/results" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: {% if request.path == '/results' %}#dc3545{% else %}#666{% endif %};">
            <i class="fas fa-list-ol" style="font-size: 16px; margin-bottom: 2px;"></i>
            <small>Results</small>
        </a>
        <a href="/guides" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: {% if request.path.startswith('/guides') %}#dc3545{% else %}#666{% endif %};">
            <i class="fas fa-book" style="font-size: 16px; margin-bottom: 2px;"></i>
            <small>Guides</small>
        </a>
        <a href="/scanner-landing" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: {% if request.path in ['/ticket-scanner', '/scan-lottery-ticket-south-africa', '/scanner-landing'] %}#dc3545{% else %}#666{% endif %};">
            <i class="fas fa-ticket-alt" style="font-size: 16px; margin-bottom: 2px;"></i>
            <small>Scanner</small>
        </a>
        <a href="/visualizations" style="flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-decoration: none; color: {% if request.path == '/visualizations' %}#dc3545{% else %}#666{% endif %};">
            <i class="fas fa-chart-bar" style="font-size: 16px; margin-bottom: 2px;"></i>
            <small>Analytics</small>
        </a>
    </div>
    
    <style>
    @media (max-width: 991px) {
        body { padding-bottom: 70px; }
    }
    </style>

    <!-- Bootstrap JavaScript Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    


    {% block scripts %}{% endblock %}
    {% block additional_scripts %}{% endblock %}
    <!-- Ad scripts have been replaced with stubs that maintain compatibility but don't show ads -->
    <script src="{{ url_for('static', filename='js/ads.js') }}"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Force light theme on all tables and rows
            const tables = document.querySelectorAll('.table, .table-lottery');
            tables.forEach(table => {
                table.style.backgroundColor = '#fff';
                table.style.color = '#000';
                
                const rows = table.querySelectorAll('tr');
                rows.forEach(row => {
                    row.style.backgroundColor = '#fff';
                    row.style.color = '#000';
                    
                    const cells = row.querySelectorAll('td, th');
                    cells.forEach(cell => {
                        cell.style.color = '#000';
                    });
                });
                
                // Make even rows light gray
                const evenRows = table.querySelectorAll('tr:nth-child(even)');
                evenRows.forEach(row => {
                    row.style.backgroundColor = '#f9f9f9';
                });
            });
            
            // Remove the lottery data dashboard section
            setTimeout(() => {
                const headings = document.querySelectorAll('h4');
                for (let heading of headings) {
                    if (heading.textContent.includes('LOTTERY DATA DASHBOARD')) {
                        // Find the parent card element and remove it
                        let element = heading;
                        // Go up to find the card div (up to 5 parent levels)
                        for (let i = 0; i < 5; i++) {
                            if (element.parentElement) {
                                element = element.parentElement;
                                if (element.classList.contains('card')) {
                                    console.log('Found the dashboard card, removing it');
                                    element.remove();
                                    break;
                                }
                            }
                        }
                    }
                }
            }, 100);
        });
    </script>
    
    <!-- Mobile Performance Optimization Scripts -->
    <script src="{{ url_for('static', filename='js/mobile-optimized.js') }}" defer></script>
    
    {% block page_scripts %}{% endblock %}
</body>
</html>